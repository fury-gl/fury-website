

  

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fury.actor &mdash; FURY 0.4.0.post314+g85a0cc8 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom_github.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> FURY
          

          
          </a>

          
            
            
              <div class="version">
                0.4.0.post314+g85a0cc8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About Fury</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../symlink/license.html">License</a></li>
</ul>
<p class="caption"><span class="caption-text">Programming with Fury</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Demos</a></li>
</ul>
<p class="caption"><span class="caption-text">Developers Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../symlink/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-history.html">Release History</a></li>
</ul>
<p class="caption"><span class="caption-text">Join our community!</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference external" href="https://join.slack.com/t/fury-gl/shared_invite/enQtNzE1NTk2Mzc3OTQyLTQyNDZiNTUxNWUyZjFmMzZlNDUxZDQ0MzllYjUyYTY1MjFhMmQyYmI3NjJkYzc3YTMwNmRjOWIzMDBjNTYzMDU">Slack Community</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mail.python.org/mailman3/lists/fury.python.org">Mailing list</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fury-gl/fury">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fury-gl/fury/issues/new/choose">File a bug</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/fury-gl/fury/issues/new/choose">Feature Request</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">FURY</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../fury.html">fury</a> &raquo;</li>
        
      <li>fury.actor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for fury.actor</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Module that provide actors to render.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">vtk</span>
<span class="kn">from</span> <span class="nn">vtk.util</span> <span class="kn">import</span> <span class="n">numpy_support</span>

<span class="kn">import</span> <span class="nn">fury.shaders</span> <span class="k">as</span> <span class="nn">fs</span>
<span class="kn">from</span> <span class="nn">fury</span> <span class="kn">import</span> <span class="n">layout</span>
<span class="kn">from</span> <span class="nn">fury.colormap</span> <span class="kn">import</span> <span class="n">colormap_lookup_table</span><span class="p">,</span> <span class="n">create_colormap</span><span class="p">,</span> <span class="n">orient2rgb</span>
<span class="kn">from</span> <span class="nn">fury.utils</span> <span class="kn">import</span> <span class="p">(</span><span class="n">lines_to_vtk_polydata</span><span class="p">,</span> <span class="n">set_input</span><span class="p">,</span> <span class="n">apply_affine</span><span class="p">,</span>
                        <span class="n">set_polydata_vertices</span><span class="p">,</span> <span class="n">set_polydata_triangles</span><span class="p">,</span>
                        <span class="n">numpy_to_vtk_matrix</span><span class="p">,</span> <span class="n">shallow_copy</span><span class="p">,</span> <span class="n">rgb_to_vtk</span><span class="p">,</span>
                        <span class="n">repeat_sources</span><span class="p">,</span> <span class="n">get_actor_from_primitive</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">fury.io</span> <span class="kn">import</span> <span class="n">load_image</span>
<span class="kn">import</span> <span class="nn">fury.primitive</span> <span class="k">as</span> <span class="nn">fp</span>


<div class="viewcode-block" id="slicer"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.slicer">[docs]</a><span class="k">def</span> <span class="nf">slicer</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
           <span class="n">lookup_colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">picking_tol</span><span class="o">=</span><span class="mf">0.025</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cut 3D scalar or rgb volumes into 2D images.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array, shape (X, Y, Z) or (X, Y, Z, 3)</span>
<span class="sd">        A grayscale or rgb 4D volume as a numpy array. If rgb then values</span>
<span class="sd">        expected on the range [0, 255].</span>
<span class="sd">    affine : array, shape (4, 4)</span>
<span class="sd">        Grid to space (usually RAS 1mm) transformation matrix. Default is None.</span>
<span class="sd">        If None then the identity matrix is used.</span>
<span class="sd">    value_range : None or tuple (2,)</span>
<span class="sd">        If None then the values will be interpolated from (data.min(),</span>
<span class="sd">        data.max()) to (0, 255). Otherwise from (value_range[0],</span>
<span class="sd">        value_range[1]) to (0, 255).</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Opacity of 0 means completely transparent and 1 completely visible.</span>
<span class="sd">    lookup_colormap : vtkLookupTable, optional</span>
<span class="sd">        If None (default) then a grayscale map is created.</span>
<span class="sd">    interpolation : string, optional</span>
<span class="sd">        If &#39;linear&#39; (default) then linear interpolation is used on the final</span>
<span class="sd">        texture mapping. If &#39;nearest&#39; then nearest neighbor interpolation is</span>
<span class="sd">        used on the final texture mapping.</span>
<span class="sd">    picking_tol : float, optional</span>
<span class="sd">        The tolerance for the vtkCellPicker, specified as a fraction of</span>
<span class="sd">        rendering window size.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    image_actor : ImageActor</span>
<span class="sd">        An object that is capable of displaying different parts of the volume</span>
<span class="sd">        as slices. The key method of this object is ``display_extent`` where</span>
<span class="sd">        one can input grid coordinates and display the slice in space (or grid)</span>
<span class="sd">        coordinates as calculated by the affine parameter.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">value_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only RGB 3D arrays are currently supported.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nb_components</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only 3D arrays are currently supported.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nb_components</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">vol</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageData</span><span class="p">()</span>
    <span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">im</span><span class="o">.</span><span class="n">SetDimensions</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
    <span class="c1"># for now setting up for 1x1x1 but transformation comes later.</span>
    <span class="n">voxsz</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="c1"># im.SetOrigin(0,0,0)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">SetSpacing</span><span class="p">(</span><span class="n">voxsz</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">voxsz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">voxsz</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">vtk_type</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">get_vtk_array_type</span><span class="p">(</span><span class="n">vol</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">AllocateScalars</span><span class="p">(</span><span class="n">vtk_type</span><span class="p">,</span> <span class="n">nb_components</span><span class="p">)</span>
    <span class="c1"># im.AllocateScalars(vtk.VTK_UNSIGNED_CHAR, nb_components)</span>

    <span class="c1"># copy data</span>
    <span class="c1"># what I do below is the same as what is</span>
    <span class="c1"># commented here but much faster</span>
    <span class="c1"># for index in ndindex(vol.shape):</span>
    <span class="c1">#     i, j, k = index</span>
    <span class="c1">#     im.SetScalarComponentFromFloat(i, j, k, 0, vol[i, j, k])</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">vol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">nb_components</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">vol</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span> <span class="n">vol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>

    <span class="n">uchar_array</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">uchar_array</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">affine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">affine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Set the transform (identity if none given)</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTransform</span><span class="p">()</span>
    <span class="n">transform_matrix</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkMatrix4x4</span><span class="p">()</span>
    <span class="n">transform_matrix</span><span class="o">.</span><span class="n">DeepCopy</span><span class="p">((</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">transform</span><span class="o">.</span><span class="n">SetMatrix</span><span class="p">(</span><span class="n">transform_matrix</span><span class="p">)</span>
    <span class="n">transform</span><span class="o">.</span><span class="n">Inverse</span><span class="p">()</span>

    <span class="c1"># Set the reslicing</span>
    <span class="n">image_resliced</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageReslice</span><span class="p">()</span>
    <span class="n">set_input</span><span class="p">(</span><span class="n">image_resliced</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">SetResliceTransform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">AutoCropOutputOn</span><span class="p">()</span>

    <span class="c1"># Adding this will allow to support anisotropic voxels</span>
    <span class="c1"># and also gives the opportunity to slice per voxel coordinates</span>
    <span class="n">RZS</span> <span class="o">=</span> <span class="n">affine</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">zooms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">RZS</span> <span class="o">*</span> <span class="n">RZS</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">SetOutputSpacing</span><span class="p">(</span><span class="o">*</span><span class="n">zooms</span><span class="p">)</span>

    <span class="n">image_resliced</span><span class="o">.</span><span class="n">SetInterpolationModeToLinear</span><span class="p">()</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">vtk_resliced_data</span> <span class="o">=</span> <span class="n">image_resliced</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()</span>

    <span class="n">ex1</span><span class="p">,</span> <span class="n">ex2</span><span class="p">,</span> <span class="n">ey1</span><span class="p">,</span> <span class="n">ey2</span><span class="p">,</span> <span class="n">ez1</span><span class="p">,</span> <span class="n">ez2</span> <span class="o">=</span> <span class="n">vtk_resliced_data</span><span class="o">.</span><span class="n">GetExtent</span><span class="p">()</span>

    <span class="n">resliced</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">vtk_to_numpy</span><span class="p">(</span>
        <span class="n">vtk_resliced_data</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">GetScalars</span><span class="p">())</span>

    <span class="c1"># swap axes here</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">resliced</span> <span class="o">=</span> <span class="n">resliced</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ez2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ey2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ex2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">resliced</span> <span class="o">=</span> <span class="n">resliced</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ez2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ey2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ex2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">ImageActor</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageActor</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">picker</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellPicker</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outline_actor</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">input_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>

            <span class="c1"># outline only</span>
            <span class="n">outline</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOutlineFilter</span><span class="p">()</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">vtk_resliced_data</span><span class="p">)</span>
            <span class="n">outline_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
            <span class="n">outline_mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">outline</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outline_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outline_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">outline_mapper</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outline_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outline_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outline_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># crucial</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">ex2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ey2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ez2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">display_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetDisplayExtent</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
            <span class="c1"># bounds = self.GetBounds()</span>
            <span class="c1"># xmin, xmax, ymin, ymax, zmin, zmax = bounds</span>
            <span class="c1"># line = np.array([[xmin, ymin, zmin]])</span>
            <span class="c1"># self.outline_actor = actor.line()</span>

        <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="n">ex1</span><span class="p">,</span> <span class="n">ex2</span><span class="p">,</span> <span class="n">ey1</span><span class="p">,</span> <span class="n">ey2</span><span class="p">,</span> <span class="n">ez2</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">ez2</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">ey1</span><span class="p">,</span> <span class="n">ey2</span><span class="p">,</span> <span class="n">ez1</span><span class="p">,</span> <span class="n">ez2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="n">ex1</span><span class="p">,</span> <span class="n">ex2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ez1</span><span class="p">,</span> <span class="n">ez2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="n">ex1</span><span class="p">,</span> <span class="n">ex2</span><span class="p">,</span> <span class="n">ey1</span><span class="p">,</span> <span class="n">ey2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">resliced_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Returns resliced array as numpy array&quot;&quot;&quot;</span>
            <span class="n">resliced</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">vtk_to_numpy</span><span class="p">(</span>
                <span class="n">vtk_resliced_data</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">GetScalars</span><span class="p">())</span>

            <span class="c1"># swap axes here</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">resliced</span> <span class="o">=</span> <span class="n">resliced</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ez2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ey2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ex2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">resliced</span> <span class="o">=</span> <span class="n">resliced</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ez2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ey2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ex2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resliced</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">resliced</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">resliced</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">resliced</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">resliced</span>

        <span class="k">def</span> <span class="nf">opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">tolerance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">picker</span><span class="o">.</span><span class="n">SetTolerance</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">im_actor</span> <span class="o">=</span> <span class="n">ImageActor</span><span class="p">()</span>
            <span class="n">im_actor</span><span class="o">.</span><span class="n">input_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
            <span class="n">im_actor</span><span class="o">.</span><span class="n">SetDisplayExtent</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">GetDisplayExtent</span><span class="p">())</span>
            <span class="n">im_actor</span><span class="o">.</span><span class="n">opacity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetOpacity</span><span class="p">())</span>
            <span class="n">im_actor</span><span class="o">.</span><span class="n">tolerance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">picker</span><span class="o">.</span><span class="n">GetTolerance</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;nearest&#39;</span><span class="p">:</span>
                <span class="n">im_actor</span><span class="o">.</span><span class="n">SetInterpolate</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">im_actor</span><span class="o">.</span><span class="n">SetInterpolate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">im_actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">BorderOn</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">im_actor</span>

        <span class="k">def</span> <span class="nf">shallow_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="c1"># TODO rename copy to shallow_copy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">value_range</span>

    <span class="n">image_actor</span> <span class="o">=</span> <span class="n">ImageActor</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">nb_components</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">lut</span> <span class="o">=</span> <span class="n">lookup_colormap</span>
        <span class="k">if</span> <span class="n">lookup_colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Create a black/white lookup table.</span>
            <span class="n">lut</span> <span class="o">=</span> <span class="n">colormap_lookup_table</span><span class="p">((</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">plane_colors</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageMapToColors</span><span class="p">()</span>
        <span class="n">plane_colors</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">lut</span><span class="p">)</span>
        <span class="n">plane_colors</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">image_resliced</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">plane_colors</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="n">image_actor</span><span class="o">.</span><span class="n">input_connection</span><span class="p">(</span><span class="n">plane_colors</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">image_actor</span><span class="o">.</span><span class="n">input_connection</span><span class="p">(</span><span class="n">image_resliced</span><span class="p">)</span>
    <span class="n">image_actor</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
    <span class="n">image_actor</span><span class="o">.</span><span class="n">opacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>
    <span class="n">image_actor</span><span class="o">.</span><span class="n">tolerance</span><span class="p">(</span><span class="n">picking_tol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;nearest&#39;</span><span class="p">:</span>
        <span class="n">image_actor</span><span class="o">.</span><span class="n">SetInterpolate</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">image_actor</span><span class="o">.</span><span class="n">SetInterpolate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">image_actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">BorderOn</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">image_actor</span></div>


<div class="viewcode-block" id="surface"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.surface">[docs]</a><span class="k">def</span> <span class="nf">surface</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subdivision</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a surface actor from an array of vertices</span>
<span class="sd">        The color and smoothness of the surface can be customized by specifying</span>
<span class="sd">        the type of subdivision algorithm and the number of subdivisions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vertices : array, shape (X, Y, Z)</span>
<span class="sd">            The point cloud defining the surface.</span>
<span class="sd">        faces : array</span>
<span class="sd">            An array of precomputed triangulation for the point cloud.</span>
<span class="sd">            It is an optional parameter, it is computed locally if None</span>
<span class="sd">        colors : (N, 3) array</span>
<span class="sd">            Specifies the colors associated with each vertex in the</span>
<span class="sd">            vertices array.</span>
<span class="sd">            Optional parameter, if not passed, all vertices</span>
<span class="sd">            are colored white</span>
<span class="sd">        smooth : string - &quot;loop&quot; or &quot;butterfly&quot;</span>
<span class="sd">            Defines the type of subdivision to be used</span>
<span class="sd">            for smoothing the surface</span>
<span class="sd">        subdivision : integer, default = 3</span>
<span class="sd">            Defines the number of subdivisions to do for</span>
<span class="sd">            each triangulation of the point cloud.</span>
<span class="sd">            The higher the value, smoother the surface</span>
<span class="sd">            but at the cost of higher computation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        surface_actor : vtkActor</span>
<span class="sd">            A vtkActor visualizing the final surface</span>
<span class="sd">            computed from the point cloud is returned.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">Delaunay</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">vertices</span><span class="p">))</span>
    <span class="n">triangle_poly_data</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">triangle_poly_data</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">triangle_poly_data</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span>\
            <span class="n">SetScalars</span><span class="p">(</span><span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">colors</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tri</span> <span class="o">=</span> <span class="n">Delaunay</span><span class="p">(</span><span class="n">vertices</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">simplices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">faces</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">faces</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">triangles</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="n">faces</span>
        <span class="n">triangles</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="n">faces</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">triangles</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">triangles</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="s1">&#39;int64&#39;</span><span class="p">:</span>
        <span class="n">triangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">triangles</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">)</span>

    <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
    <span class="n">cells</span><span class="o">.</span><span class="n">SetCells</span><span class="p">(</span><span class="n">triangles</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                   <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtkIdTypeArray</span><span class="p">(</span><span class="n">triangles</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">triangle_poly_data</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

    <span class="n">clean_poly_data</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCleanPolyData</span><span class="p">()</span>
    <span class="n">clean_poly_data</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">triangle_poly_data</span><span class="p">)</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">surface_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smooth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">triangle_poly_data</span><span class="p">)</span>
        <span class="n">surface_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">smooth</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
        <span class="n">smooth_loop</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLoopSubdivisionFilter</span><span class="p">()</span>
        <span class="n">smooth_loop</span><span class="o">.</span><span class="n">SetNumberOfSubdivisions</span><span class="p">(</span><span class="n">subdivision</span><span class="p">)</span>
        <span class="n">smooth_loop</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">clean_poly_data</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">smooth_loop</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">surface_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">smooth</span> <span class="o">==</span> <span class="s2">&quot;butterfly&quot;</span><span class="p">:</span>
        <span class="n">smooth_butterfly</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkButterflySubdivisionFilter</span><span class="p">()</span>
        <span class="n">smooth_butterfly</span><span class="o">.</span><span class="n">SetNumberOfSubdivisions</span><span class="p">(</span><span class="n">subdivision</span><span class="p">)</span>
        <span class="n">smooth_butterfly</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">clean_poly_data</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">smooth_butterfly</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">surface_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">surface_actor</span></div>


<div class="viewcode-block" id="contour_from_roi"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.contour_from_roi">[docs]</a><span class="k">def</span> <span class="nf">contour_from_roi</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate surface actor from a binary ROI.</span>

<span class="sd">    The color and opacity of the surface can be customized.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array, shape (X, Y, Z)</span>
<span class="sd">        An ROI file that will be binarized and displayed.</span>
<span class="sd">    affine : array, shape (4, 4)</span>
<span class="sd">        Grid to space (usually RAS 1mm) transformation matrix. Default is None.</span>
<span class="sd">        If None then the identity matrix is used.</span>
<span class="sd">    color : (1, 3) ndarray</span>
<span class="sd">        RGB values in [0,1].</span>
<span class="sd">    opacity : float</span>
<span class="sd">        Opacity of surface between 0 and 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    contour_assembly : vtkAssembly</span>
<span class="sd">        ROI surface object displayed in space</span>
<span class="sd">        coordinates as calculated by the affine parameter.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only 3D arrays are currently supported.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nb_components</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">fp</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageData</span><span class="p">()</span>
    <span class="n">di</span><span class="p">,</span> <span class="n">dj</span><span class="p">,</span> <span class="n">dk</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">im</span><span class="o">.</span><span class="n">SetDimensions</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">dj</span><span class="p">,</span> <span class="n">dk</span><span class="p">)</span>
    <span class="n">voxsz</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="c1"># im.SetOrigin(0,0,0)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">SetSpacing</span><span class="p">(</span><span class="n">voxsz</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">voxsz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">voxsz</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">im</span><span class="o">.</span><span class="n">AllocateScalars</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_UNSIGNED_CHAR</span><span class="p">,</span> <span class="n">nb_components</span><span class="p">)</span>

    <span class="c1"># copy data</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">vol</span><span class="p">)</span>

    <span class="n">vol</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="n">uchar_array</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">uchar_array</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">affine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">affine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Set the transform (identity if none given)</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTransform</span><span class="p">()</span>
    <span class="n">transform_matrix</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkMatrix4x4</span><span class="p">()</span>
    <span class="n">transform_matrix</span><span class="o">.</span><span class="n">DeepCopy</span><span class="p">((</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">affine</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">transform</span><span class="o">.</span><span class="n">SetMatrix</span><span class="p">(</span><span class="n">transform_matrix</span><span class="p">)</span>
    <span class="n">transform</span><span class="o">.</span><span class="n">Inverse</span><span class="p">()</span>

    <span class="c1"># Set the reslicing</span>
    <span class="n">image_resliced</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageReslice</span><span class="p">()</span>
    <span class="n">set_input</span><span class="p">(</span><span class="n">image_resliced</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">SetResliceTransform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">AutoCropOutputOn</span><span class="p">()</span>

    <span class="c1"># Adding this will allow to support anisotropic voxels</span>
    <span class="c1"># and also gives the opportunity to slice per voxel coordinates</span>

    <span class="n">rzs</span> <span class="o">=</span> <span class="n">affine</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">zooms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rzs</span> <span class="o">*</span> <span class="n">rzs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">SetOutputSpacing</span><span class="p">(</span><span class="o">*</span><span class="n">zooms</span><span class="p">)</span>

    <span class="n">image_resliced</span><span class="o">.</span><span class="n">SetInterpolationModeToLinear</span><span class="p">()</span>
    <span class="n">image_resliced</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">skin_extractor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkContourFilter</span><span class="p">()</span>
    <span class="n">skin_extractor</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">image_resliced</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>

    <span class="n">skin_extractor</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">skin_normals</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataNormals</span><span class="p">()</span>
    <span class="n">skin_normals</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">skin_extractor</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">skin_normals</span><span class="o">.</span><span class="n">SetFeatureAngle</span><span class="p">(</span><span class="mf">60.0</span><span class="p">)</span>

    <span class="n">skin_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">skin_mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">skin_normals</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">skin_mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOff</span><span class="p">()</span>

    <span class="n">skin_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>

    <span class="n">skin_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">skin_mapper</span><span class="p">)</span>
    <span class="n">skin_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

    <span class="n">skin_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">skin_actor</span></div>


<div class="viewcode-block" id="streamtube"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.streamtube">[docs]</a><span class="k">def</span> <span class="nf">streamtube</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">tube_sides</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
               <span class="n">lod</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lod_points</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">4</span><span class="p">,</span> <span class="n">lod_points_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
               <span class="n">spline_subdiv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lookup_colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Use streamtubes to visualize polylines</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines : list</span>
<span class="sd">        list of N curves represented as 2D ndarrays</span>

<span class="sd">    colors : array (N, 3), list of arrays, tuple (3,), array (K,), &quot;RGB&quot;</span>
<span class="sd">        If None or False, no coloring is done</span>
<span class="sd">        If &quot;RGB&quot; then a standard orientation colormap is used for every line.</span>
<span class="sd">        If one tuple of color is used. Then all streamlines will have the same</span>
<span class="sd">        colour.</span>
<span class="sd">        If an array (N, 3) is given, where N is equal to the number of lines.</span>
<span class="sd">        Then every line is coloured with a different RGB color.</span>
<span class="sd">        If a list of RGB arrays is given then every point of every line takes</span>
<span class="sd">        a different color.</span>
<span class="sd">        If an array (K, 3) is given, where K is the number of points of all</span>
<span class="sd">        lines then every point is colored with a different RGB color.</span>
<span class="sd">        If an array (K,) is given, where K is the number of points of all</span>
<span class="sd">        lines then these are considered as the values to be used by the</span>
<span class="sd">        colormap.</span>
<span class="sd">        If an array (L,) is given, where L is the number of streamlines then</span>
<span class="sd">        these are considered as the values to be used by the colormap per</span>
<span class="sd">        streamline.</span>
<span class="sd">        If an array (X, Y, Z) or (X, Y, Z, 3) is given then the values for the</span>
<span class="sd">        colormap are interpolated automatically using trilinear interpolation.</span>

<span class="sd">    opacity : float, optional</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque). Default is 1.</span>
<span class="sd">    linewidth : float, optional</span>
<span class="sd">        Default is 0.01.</span>
<span class="sd">    tube_sides : int, optional</span>
<span class="sd">        Default is 9.</span>
<span class="sd">    lod : bool, optional</span>
<span class="sd">        Use vtkLODActor(level of detail) rather than vtkActor. Default is True.</span>
<span class="sd">        Level of detail actors do not render the full geometry when the</span>
<span class="sd">        frame rate is low.</span>
<span class="sd">    lod_points : int, optional</span>
<span class="sd">        Number of points to be used when LOD is in effect. Default is 10000.</span>
<span class="sd">    lod_points_size : int, optional</span>
<span class="sd">        Size of points when lod is in effect. Default is 3.</span>
<span class="sd">    spline_subdiv : int, optional</span>
<span class="sd">        Number of splines subdivision to smooth streamtubes. Default is None.</span>
<span class="sd">    lookup_colormap : vtkLookupTable, optional</span>
<span class="sd">        Add a default lookup table to the colormap. Default is None which calls</span>
<span class="sd">        :func:`fury.actor.colormap_lookup_table`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from fury import actor, window</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; lines = [np.random.rand(10, 3), np.random.rand(20, 3)]</span>
<span class="sd">    &gt;&gt;&gt; colors = np.random.rand(2, 3)</span>
<span class="sd">    &gt;&gt;&gt; c = actor.streamtube(lines, colors)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(c)</span>
<span class="sd">    &gt;&gt;&gt; #window.show(scene)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Streamtubes can be heavy on GPU when loading many streamlines and</span>
<span class="sd">    therefore, you may experience slow rendering time depending on system GPU.</span>
<span class="sd">    A solution to this problem is to reduce the number of points in each</span>
<span class="sd">    streamline. In Dipy we provide an algorithm that will reduce the number of</span>
<span class="sd">    points on the straighter parts of the streamline but keep more points on</span>
<span class="sd">    the curvier parts. This can be used in the following way::</span>

<span class="sd">        from dipy.tracking.distances import approx_polygon_track</span>
<span class="sd">        lines = [approx_polygon_track(line, 0.2) for line in lines]</span>

<span class="sd">    Alternatively we suggest using the ``line`` actor which is much more</span>
<span class="sd">    efficient.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :func:`fury.actor.line`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Poly data with lines and colors</span>
    <span class="n">poly_data</span><span class="p">,</span> <span class="n">color_is_scalar</span> <span class="o">=</span> <span class="n">lines_to_vtk_polydata</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="n">next_input</span> <span class="o">=</span> <span class="n">poly_data</span>

    <span class="c1"># Set Normals</span>
    <span class="n">poly_normals</span> <span class="o">=</span> <span class="n">set_input</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataNormals</span><span class="p">(),</span> <span class="n">next_input</span><span class="p">)</span>
    <span class="n">poly_normals</span><span class="o">.</span><span class="n">ComputeCellNormalsOn</span><span class="p">()</span>
    <span class="n">poly_normals</span><span class="o">.</span><span class="n">ComputePointNormalsOn</span><span class="p">()</span>
    <span class="n">poly_normals</span><span class="o">.</span><span class="n">ConsistencyOn</span><span class="p">()</span>
    <span class="n">poly_normals</span><span class="o">.</span><span class="n">AutoOrientNormalsOn</span><span class="p">()</span>
    <span class="n">poly_normals</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="n">next_input</span> <span class="o">=</span> <span class="n">poly_normals</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">()</span>

    <span class="c1"># Spline interpolation</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">spline_subdiv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">spline_subdiv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">spline_filter</span> <span class="o">=</span> <span class="n">set_input</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkSplineFilter</span><span class="p">(),</span> <span class="n">next_input</span><span class="p">)</span>
        <span class="n">spline_filter</span><span class="o">.</span><span class="n">SetSubdivideToSpecified</span><span class="p">()</span>
        <span class="n">spline_filter</span><span class="o">.</span><span class="n">SetNumberOfSubdivisions</span><span class="p">(</span><span class="n">spline_subdiv</span><span class="p">)</span>
        <span class="n">spline_filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="n">next_input</span> <span class="o">=</span> <span class="n">spline_filter</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">()</span>

    <span class="c1"># Add thickness to the resulting lines</span>
    <span class="n">tube_filter</span> <span class="o">=</span> <span class="n">set_input</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkTubeFilter</span><span class="p">(),</span> <span class="n">next_input</span><span class="p">)</span>
    <span class="n">tube_filter</span><span class="o">.</span><span class="n">SetNumberOfSides</span><span class="p">(</span><span class="n">tube_sides</span><span class="p">)</span>
    <span class="n">tube_filter</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span>
    <span class="c1"># TODO using the line above we will be able to visualize</span>
    <span class="c1"># streamtubes of varying radius</span>
    <span class="c1"># tube_filter.SetVaryRadiusToVaryRadiusByScalar()</span>
    <span class="n">tube_filter</span><span class="o">.</span><span class="n">CappingOn</span><span class="p">()</span>
    <span class="n">tube_filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="n">next_input</span> <span class="o">=</span> <span class="n">tube_filter</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">()</span>

    <span class="c1"># Poly mapper</span>
    <span class="n">poly_mapper</span> <span class="o">=</span> <span class="n">set_input</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">(),</span> <span class="n">next_input</span><span class="p">)</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOn</span><span class="p">()</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointFieldData</span><span class="p">()</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">SelectColorArray</span><span class="p">(</span><span class="s2">&quot;Colors&quot;</span><span class="p">)</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="c1"># Color Scale with a lookup table</span>
    <span class="k">if</span> <span class="n">color_is_scalar</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lookup_colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lookup_colormap</span> <span class="o">=</span> <span class="n">colormap_lookup_table</span><span class="p">()</span>
        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">lookup_colormap</span><span class="p">)</span>
        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">UseLookupTableScalarRangeOn</span><span class="p">()</span>
        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="c1"># Set Actor</span>
    <span class="k">if</span> <span class="n">lod</span><span class="p">:</span>
        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLODActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetNumberOfCloudPoints</span><span class="p">(</span><span class="n">lod_points</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetPointSize</span><span class="p">(</span><span class="n">lod_points_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>

    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">poly_mapper</span><span class="p">)</span>

    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetInterpolationToPhong</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">BackfaceCullingOn</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="line"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.line">[docs]</a><span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">spline_subdiv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lod</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lod_points</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">4</span><span class="p">,</span> <span class="n">lod_points_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
         <span class="n">lookup_colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">depth_cue</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fake_tube</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create an actor for one or more lines.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------</span>
<span class="sd">    lines :  list of arrays</span>

<span class="sd">    colors : array (N, 3), list of arrays, tuple (3,), array (K,), &quot;RGB&quot;</span>
<span class="sd">        If None or False, no coloring is done</span>
<span class="sd">        If &quot;RGB&quot; then a standard orientation colormap is used for every line.</span>
<span class="sd">        If one tuple of color is used. Then all streamlines will have the same</span>
<span class="sd">        colour.</span>
<span class="sd">        If an array (N, 3) is given, where N is equal to the number of lines.</span>
<span class="sd">        Then every line is coloured with a different RGB color.</span>
<span class="sd">        If a list of RGB arrays is given then every point of every line takes</span>
<span class="sd">        a different color.</span>
<span class="sd">        If an array (K, 3) is given, where K is the number of points of all</span>
<span class="sd">        lines then every point is colored with a different RGB color.</span>
<span class="sd">        If an array (K,) is given, where K is the number of points of all</span>
<span class="sd">        lines then these are considered as the values to be used by the</span>
<span class="sd">        colormap.</span>
<span class="sd">        If an array (L,) is given, where L is the number of streamlines then</span>
<span class="sd">        these are considered as the values to be used by the colormap per</span>
<span class="sd">        streamline.</span>
<span class="sd">        If an array (X, Y, Z) or (X, Y, Z, 3) is given then the values for the</span>
<span class="sd">        colormap are interpolated automatically using trilinear interpolation.</span>

<span class="sd">    opacity : float, optional</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque). Default is 1.</span>

<span class="sd">    linewidth : float, optional</span>
<span class="sd">        Line thickness. Default is 1.</span>
<span class="sd">    spline_subdiv : int, optional</span>
<span class="sd">        Number of splines subdivision to smooth streamtubes. Default is None</span>
<span class="sd">        which means no subdivision.</span>
<span class="sd">    lod : bool, optional</span>
<span class="sd">        Use vtkLODActor(level of detail) rather than vtkActor. Default is True.</span>
<span class="sd">        Level of detail actors do not render the full geometry when the</span>
<span class="sd">        frame rate is low.</span>
<span class="sd">    lod_points : int, optional</span>
<span class="sd">        Number of points to be used when LOD is in effect. Default is 10000.</span>
<span class="sd">    lod_points_size : int</span>
<span class="sd">        Size of points when lod is in effect. Default is 3.</span>
<span class="sd">    lookup_colormap : vtkLookupTable, optional</span>
<span class="sd">        Add a default lookup table to the colormap. Default is None which calls</span>
<span class="sd">        :func:`fury.actor.colormap_lookup_table`.</span>
<span class="sd">    depth_cue : boolean, optional</span>
<span class="sd">        Add a size depth cue so that lines shrink with distance to the camera.</span>
<span class="sd">        Works best with linewidth &lt;= 1.</span>
<span class="sd">    fake_tube: boolean, optional</span>
<span class="sd">        Add shading to lines to approximate the look of tubes.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    v : vtkActor or vtkLODActor object</span>
<span class="sd">        Line.</span>

<span class="sd">    Examples</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt;&gt;&gt; from fury import actor, window</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; lines = [np.random.rand(10, 3), np.random.rand(20, 3)]</span>
<span class="sd">    &gt;&gt;&gt; colors = np.random.rand(2, 3)</span>
<span class="sd">    &gt;&gt;&gt; c = actor.line(lines, colors)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(c)</span>
<span class="sd">    &gt;&gt;&gt; #window.show(scene)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Poly data with lines and colors</span>
    <span class="n">poly_data</span><span class="p">,</span> <span class="n">color_is_scalar</span> <span class="o">=</span> <span class="n">lines_to_vtk_polydata</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="n">next_input</span> <span class="o">=</span> <span class="n">poly_data</span>

    <span class="c1"># use spline interpolation</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">spline_subdiv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">spline_subdiv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">spline_filter</span> <span class="o">=</span> <span class="n">set_input</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkSplineFilter</span><span class="p">(),</span> <span class="n">next_input</span><span class="p">)</span>
        <span class="n">spline_filter</span><span class="o">.</span><span class="n">SetSubdivideToSpecified</span><span class="p">()</span>
        <span class="n">spline_filter</span><span class="o">.</span><span class="n">SetNumberOfSubdivisions</span><span class="p">(</span><span class="n">spline_subdiv</span><span class="p">)</span>
        <span class="n">spline_filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="n">next_input</span> <span class="o">=</span> <span class="n">spline_filter</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">()</span>

    <span class="n">poly_mapper</span> <span class="o">=</span> <span class="n">set_input</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">(),</span> <span class="n">next_input</span><span class="p">)</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOn</span><span class="p">()</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointFieldData</span><span class="p">()</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">SelectColorArray</span><span class="p">(</span><span class="s2">&quot;Colors&quot;</span><span class="p">)</span>
    <span class="n">poly_mapper</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">depth_cue</span><span class="p">:</span>
        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">SetGeometryShaderCode</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;line.geom&quot;</span><span class="p">))</span>

        <span class="nd">@vtk</span><span class="o">.</span><span class="n">calldata_type</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_OBJECT</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">vtkShaderCallback</span><span class="p">(</span><span class="n">_caller</span><span class="p">,</span> <span class="n">_event</span><span class="p">,</span> <span class="n">calldata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">program</span> <span class="o">=</span> <span class="n">calldata</span>
            <span class="k">if</span> <span class="n">program</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">program</span><span class="o">.</span><span class="n">SetUniformf</span><span class="p">(</span><span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>

        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkCommand</span><span class="o">.</span><span class="n">UpdateShaderEvent</span><span class="p">,</span>
                                <span class="n">vtkShaderCallback</span><span class="p">)</span>

    <span class="c1"># Color Scale with a lookup table</span>
    <span class="k">if</span> <span class="n">color_is_scalar</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lookup_colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lookup_colormap</span> <span class="o">=</span> <span class="n">colormap_lookup_table</span><span class="p">()</span>

        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">lookup_colormap</span><span class="p">)</span>
        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">UseLookupTableScalarRangeOn</span><span class="p">()</span>
        <span class="n">poly_mapper</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="c1"># Set Actor</span>
    <span class="k">if</span> <span class="n">lod</span><span class="p">:</span>
        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLODActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetNumberOfCloudPoints</span><span class="p">(</span><span class="n">lod_points</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetPointSize</span><span class="p">(</span><span class="n">lod_points_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>

    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">poly_mapper</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fake_tube</span><span class="p">:</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="scalar_bar"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.scalar_bar">[docs]</a><span class="k">def</span> <span class="nf">scalar_bar</span><span class="p">(</span><span class="n">lookup_table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Default scalar bar actor for a given colormap (colorbar)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lookup_table : vtkLookupTable or None</span>
<span class="sd">        If None then ``colormap_lookup_table`` is called with default options.</span>
<span class="sd">    title : str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    scalar_bar : vtkScalarBarActor</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :func:`fury.actor.colormap_lookup_table`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_table_copy</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLookupTable</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">lookup_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lookup_table</span> <span class="o">=</span> <span class="n">colormap_lookup_table</span><span class="p">()</span>
    <span class="c1"># Deepcopy the lookup_table because sometimes vtkPolyDataMapper deletes it</span>
    <span class="n">lookup_table_copy</span><span class="o">.</span><span class="n">DeepCopy</span><span class="p">(</span><span class="n">lookup_table</span><span class="p">)</span>
    <span class="n">scalar_bar</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkScalarBarActor</span><span class="p">()</span>
    <span class="n">scalar_bar</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">scalar_bar</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">lookup_table_copy</span><span class="p">)</span>
    <span class="n">scalar_bar</span><span class="o">.</span><span class="n">SetNumberOfLabels</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scalar_bar</span></div>


<div class="viewcode-block" id="axes"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.axes">[docs]</a><span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">colorx</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colory</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colorz</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
         <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create an actor with the coordinate&#39;s system axes where</span>
<span class="sd">    red = x, green = y, blue = z.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scale : tuple (3,)</span>
<span class="sd">        Axes size e.g. (100, 100, 100). Default is (1, 1, 1).</span>
<span class="sd">    colorx : tuple (3,)</span>
<span class="sd">        x-axis color. Default red (1, 0, 0).</span>
<span class="sd">    colory : tuple (3,)</span>
<span class="sd">        y-axis color. Default green (0, 1, 0).</span>
<span class="sd">    colorz : tuple (3,)</span>
<span class="sd">        z-axis color. Default blue (0, 0, 1).</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque). Default is 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">dirs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">colorx</span> <span class="o">+</span> <span class="p">(</span><span class="n">opacity</span><span class="p">,),</span>
                       <span class="n">colory</span> <span class="o">+</span> <span class="p">(</span><span class="n">opacity</span><span class="p">,),</span>
                       <span class="n">colorz</span> <span class="o">+</span> <span class="p">(</span><span class="n">opacity</span><span class="p">,)])</span>

    <span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">arrow</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">scales</span><span class="p">)</span></div>


<div class="viewcode-block" id="odf_slicer"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.odf_slicer">[docs]</a><span class="k">def</span> <span class="nf">odf_slicer</span><span class="p">(</span><span class="n">odfs</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sphere</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span>
               <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radial_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
               <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;blues&#39;</span><span class="p">,</span> <span class="n">global_cm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Slice spherical fields in native or world coordinates</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    odfs : ndarray</span>
<span class="sd">        4D array of spherical functions</span>
<span class="sd">    affine : array</span>
<span class="sd">        4x4 transformation array from native coordinates to world coordinates</span>
<span class="sd">    mask : ndarray</span>
<span class="sd">        3D mask</span>
<span class="sd">    sphere : Sphere</span>
<span class="sd">        a sphere</span>
<span class="sd">    scale : float</span>
<span class="sd">        Distance between spheres.</span>
<span class="sd">    norm : bool</span>
<span class="sd">        Normalize `sphere_values`.</span>
<span class="sd">    radial_scale : bool</span>
<span class="sd">        Scale sphere points according to odf values.</span>
<span class="sd">    opacity : float</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque). Default is 1.</span>
<span class="sd">    colormap : None or str</span>
<span class="sd">        If None then white color is used. Otherwise the name of colormap is</span>
<span class="sd">        given. Matplotlib colormaps are supported (e.g., &#39;inferno&#39;).</span>
<span class="sd">    global_cm : bool</span>
<span class="sd">        If True the colormap will be applied in all ODFs. If False</span>
<span class="sd">        it will be applied individually at each voxel (default False).</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    actor : vtkActor</span>
<span class="sd">        Spheres</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">odfs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>

    <span class="n">szx</span><span class="p">,</span> <span class="n">szy</span><span class="p">,</span> <span class="n">szz</span> <span class="o">=</span> <span class="n">odfs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">OdfSlicerActor</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkLODActor</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mapper</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">display_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
            <span class="n">tmp_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">odfs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
            <span class="n">tmp_mask</span><span class="p">[</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span><span class="n">y2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z1</span><span class="p">:</span><span class="n">z2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">tmp_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">tmp_mask</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mapper</span> <span class="o">=</span> <span class="n">_odf_slicer_mapper</span><span class="p">(</span><span class="n">odfs</span><span class="o">=</span><span class="n">odfs</span><span class="p">,</span>
                                             <span class="n">affine</span><span class="o">=</span><span class="n">affine</span><span class="p">,</span>
                                             <span class="n">mask</span><span class="o">=</span><span class="n">tmp_mask</span><span class="p">,</span>
                                             <span class="n">sphere</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span>
                                             <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
                                             <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                                             <span class="n">radial_scale</span><span class="o">=</span><span class="n">radial_scale</span><span class="p">,</span>
                                             <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                                             <span class="n">global_cm</span><span class="o">=</span><span class="n">global_cm</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapper</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                    <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

    <span class="n">odf_actor</span> <span class="o">=</span> <span class="n">OdfSlicerActor</span><span class="p">()</span>
    <span class="n">odf_actor</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">odf_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">odf_actor</span></div>


<span class="k">def</span> <span class="nf">_odf_slicer_mapper</span><span class="p">(</span><span class="n">odfs</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sphere</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span>
                       <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radial_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span>
                       <span class="n">global_cm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Helper function for slicing spherical fields</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    odfs : ndarray</span>
<span class="sd">        4D array of spherical functions</span>
<span class="sd">    affine : array</span>
<span class="sd">        4x4 transformation array from native coordinates to world coordinates</span>
<span class="sd">    mask : ndarray</span>
<span class="sd">        3D mask</span>
<span class="sd">    sphere : Sphere</span>
<span class="sd">        a sphere</span>
<span class="sd">    scale : float</span>
<span class="sd">        Distance between spheres.</span>
<span class="sd">    norm : bool</span>
<span class="sd">        Normalize `sphere_values`.</span>
<span class="sd">    radial_scale : bool</span>
<span class="sd">        Scale sphere points according to odf values.</span>
<span class="sd">    colormap : None or str</span>
<span class="sd">        If None then sphere vertices are used to compute orientation-based</span>
<span class="sd">        color. Otherwise the name of colormap is given. Matplotlib colormaps</span>
<span class="sd">        are supported (e.g., &#39;inferno&#39;).</span>
<span class="sd">    global_cm : bool</span>
<span class="sd">        If True the colormap will be applied in all ODFs. If False</span>
<span class="sd">        it will be applied individually at each voxel (default False).</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    mapper : vtkPolyDataMapper</span>
<span class="sd">        Spheres mapper</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">odfs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mask</span>

    <span class="n">ijk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mask</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ijk</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">affine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ijk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">apply_affine</span><span class="p">(</span><span class="n">affine</span><span class="p">,</span> <span class="n">ijk</span><span class="p">))</span>

    <span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">vertices</span>

    <span class="n">all_xyz</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_faces</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_ms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ijk</span><span class="p">):</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">odfs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">radial_scale</span><span class="p">:</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">*</span> <span class="n">m</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="n">vertices</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">all_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">xyz</span> <span class="o">+</span> <span class="n">center</span><span class="p">)</span>
        <span class="n">all_faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">faces</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">all_ms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="n">all_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">all_xyz</span><span class="p">))</span>
    <span class="n">all_xyz_vtk</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">all_xyz</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">all_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">all_faces</span><span class="p">)</span>
    <span class="n">all_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">all_faces</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span>
                           <span class="n">all_faces</span><span class="p">))</span>
    <span class="n">ncells</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_faces</span><span class="p">)</span>

    <span class="n">all_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">all_faces</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>
    <span class="n">all_faces_vtk</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtkIdTypeArray</span><span class="p">(</span><span class="n">all_faces</span><span class="p">,</span>
                                                          <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">global_cm</span><span class="p">:</span>
        <span class="n">all_ms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">all_ms</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">all_xyz_vtk</span><span class="p">)</span>

    <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
    <span class="n">cells</span><span class="o">.</span><span class="n">SetCells</span><span class="p">(</span><span class="n">ncells</span><span class="p">,</span> <span class="n">all_faces_vtk</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">global_cm</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;if global_cm=True, colormap must be defined&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">create_colormap</span><span class="p">(</span><span class="n">all_ms</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">colormap</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ijk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span> <span class="o">+</span> <span class="n">sphere</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ijk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">colormap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">create_colormap</span><span class="p">(</span><span class="n">all_ms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">colormap</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">orient2rgb</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
            <span class="n">cols</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="p">(</span><span class="n">cols</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">cols</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">cols</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>

    <span class="n">vtk_colors</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">cols</span><span class="p">),</span>
        <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">array_type</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_UNSIGNED_CHAR</span><span class="p">)</span>

    <span class="n">vtk_colors</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s2">&quot;Colors&quot;</span><span class="p">)</span>

    <span class="n">polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">polydata</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

    <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">vtk_colors</span><span class="p">)</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">polydata</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mapper</span>


<span class="k">def</span> <span class="nf">_makeNd</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">ndim</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pads as many 1s at the beginning of array&#39;s shape as are need to give</span>
<span class="sd">    array ndim dimensions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ndim</span> <span class="o">-</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span> <span class="o">+</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_shape</span><span class="p">)</span>


<div class="viewcode-block" id="tensor_slicer"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.tensor_slicer">[docs]</a><span class="k">def</span> <span class="nf">tensor_slicer</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sphere</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span>
                  <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">scalar_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Slice many tensors as ellipsoids in native or world coordinates.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    evals : (3,) or (X, 3) or (X, Y, 3) or (X, Y, Z, 3) ndarray</span>
<span class="sd">        eigenvalues</span>
<span class="sd">    evecs : (3, 3) or (X, 3, 3) or (X, Y, 3, 3) or (X, Y, Z, 3, 3) ndarray</span>
<span class="sd">        eigenvectors</span>
<span class="sd">    affine : array</span>
<span class="sd">        4x4 transformation array from native coordinates to world coordinates*</span>
<span class="sd">    mask : ndarray</span>
<span class="sd">        3D mask</span>
<span class="sd">    sphere : Sphere</span>
<span class="sd">        a sphere</span>
<span class="sd">    scale : float</span>
<span class="sd">        Distance between spheres.</span>
<span class="sd">    norm : bool</span>
<span class="sd">        Normalize `sphere_values`.</span>
<span class="sd">    opacity : float</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque). Default is 1.</span>
<span class="sd">    scalar_colors : (3,) or (X, 3) or (X, Y, 3) or (X, Y, Z, 3) ndarray</span>
<span class="sd">        RGB colors used to show the tensors</span>
<span class="sd">        Default None, color the ellipsoids using ``color_fa``</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    actor : vtkActor</span>
<span class="sd">        Ellipsoid</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">evals</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">evecs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Eigenvalues shape </span><span class="si">{}</span><span class="s2"> is incompatible with eigenvectors&#39; </span><span class="si">{}</span><span class="s2">.&quot;</span>
            <span class="s2">&quot; Please provide eigenvalue and&quot;</span>
            <span class="s2">&quot; eigenvector arrays that have compatible dimensions.&quot;</span>
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">evecs</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>

    <span class="n">szx</span><span class="p">,</span> <span class="n">szy</span><span class="p">,</span> <span class="n">szz</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">TensorSlicerActor</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkLODActor</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mapper</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">display_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
            <span class="n">tmp_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
            <span class="n">tmp_mask</span><span class="p">[</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span><span class="n">y2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z1</span><span class="p">:</span><span class="n">z2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">tmp_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">tmp_mask</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mapper</span> <span class="o">=</span> <span class="n">_tensor_slicer_mapper</span><span class="p">(</span><span class="n">evals</span><span class="o">=</span><span class="n">evals</span><span class="p">,</span>
                                                <span class="n">evecs</span><span class="o">=</span><span class="n">evecs</span><span class="p">,</span>
                                                <span class="n">affine</span><span class="o">=</span><span class="n">affine</span><span class="p">,</span>
                                                <span class="n">mask</span><span class="o">=</span><span class="n">tmp_mask</span><span class="p">,</span>
                                                <span class="n">sphere</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span>
                                                <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
                                                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                                                <span class="n">scalar_colors</span><span class="o">=</span><span class="n">scalar_colors</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapper</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                    <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

    <span class="n">tensor_actor</span> <span class="o">=</span> <span class="n">TensorSlicerActor</span><span class="p">()</span>
    <span class="n">tensor_actor</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>

    <span class="n">tensor_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tensor_actor</span></div>


<span class="k">def</span> <span class="nf">_tensor_slicer_mapper</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sphere</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">scale</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scalar_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function for slicing tensor fields</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    evals : (3,) or (X, 3) or (X, Y, 3) or (X, Y, Z, 3) ndarray</span>
<span class="sd">        eigenvalues</span>
<span class="sd">    evecs : (3, 3) or (X, 3, 3) or (X, Y, 3, 3) or (X, Y, Z, 3, 3) ndarray</span>
<span class="sd">        eigenvectors</span>
<span class="sd">    affine : array</span>
<span class="sd">        4x4 transformation array from native coordinates to world coordinates</span>
<span class="sd">    mask : ndarray</span>
<span class="sd">        3D mask</span>
<span class="sd">    sphere : Sphere</span>
<span class="sd">        a sphere</span>
<span class="sd">    scale : float</span>
<span class="sd">        Distance between spheres.</span>
<span class="sd">    norm : bool</span>
<span class="sd">        Normalize `sphere_values`.</span>
<span class="sd">    scalar_colors : (3,) or (X, 3) or (X, Y, 3) or (X, Y, Z, 3) ndarray</span>
<span class="sd">        RGB colors used to show the tensors</span>
<span class="sd">        Default None, color the ellipsoids using ``color_fa``</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    mapper : vtkPolyDataMapper</span>
<span class="sd">        Ellipsoid mapper</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mask</span>

    <span class="n">ijk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mask</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ijk</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">affine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ijk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">apply_affine</span><span class="p">(</span><span class="n">affine</span><span class="p">,</span> <span class="n">ijk</span><span class="p">))</span>

    <span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">vertices</span>

    <span class="k">if</span> <span class="n">scalar_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">dipy.reconst.dti</span> <span class="kn">import</span> <span class="n">color_fa</span><span class="p">,</span> <span class="n">fractional_anisotropy</span>
        <span class="n">cfa</span> <span class="o">=</span> <span class="n">color_fa</span><span class="p">(</span><span class="n">fractional_anisotropy</span><span class="p">(</span><span class="n">evals</span><span class="p">),</span> <span class="n">evecs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cfa</span> <span class="o">=</span> <span class="n">_makeNd</span><span class="p">(</span><span class="n">scalar_colors</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ijk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span> <span class="o">+</span> <span class="n">sphere</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>

    <span class="n">all_xyz</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_faces</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ijk</span><span class="p">):</span>
        <span class="n">ea</span> <span class="o">=</span> <span class="n">evals</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))]</span>
        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">ea</span> <span class="o">/=</span> <span class="n">ea</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">ea</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">ea</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

        <span class="n">ev</span> <span class="o">=</span> <span class="n">evecs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">vertices</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>

        <span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">T</span>
        <span class="n">all_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">xyz</span> <span class="o">+</span> <span class="n">center</span><span class="p">)</span>
        <span class="n">all_faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">faces</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">cols</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">cfa</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;ubyte&#39;</span><span class="p">)</span>

    <span class="n">all_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">all_xyz</span><span class="p">))</span>
    <span class="n">all_xyz_vtk</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">all_xyz</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">all_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">all_faces</span><span class="p">)</span>
    <span class="n">all_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">all_faces</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span>
                           <span class="n">all_faces</span><span class="p">))</span>
    <span class="n">ncells</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_faces</span><span class="p">)</span>

    <span class="n">all_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">all_faces</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>
    <span class="n">all_faces_vtk</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtkIdTypeArray</span><span class="p">(</span><span class="n">all_faces</span><span class="p">,</span>
                                                          <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">all_xyz_vtk</span><span class="p">)</span>

    <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
    <span class="n">cells</span><span class="o">.</span><span class="n">SetCells</span><span class="p">(</span><span class="n">ncells</span><span class="p">,</span> <span class="n">all_faces_vtk</span><span class="p">)</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="p">(</span><span class="n">cols</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">cols</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">cols</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>

    <span class="n">vtk_colors</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span>
        <span class="n">cols</span><span class="p">,</span>
        <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">array_type</span><span class="o">=</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_UNSIGNED_CHAR</span><span class="p">)</span>

    <span class="n">vtk_colors</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s2">&quot;Colors&quot;</span><span class="p">)</span>

    <span class="n">polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">polydata</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
    <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">vtk_colors</span><span class="p">)</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">polydata</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mapper</span>


<div class="viewcode-block" id="peak_slicer"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.peak_slicer">[docs]</a><span class="k">def</span> <span class="nf">peak_slicer</span><span class="p">(</span><span class="n">peaks_dirs</span><span class="p">,</span> <span class="n">peaks_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">lod</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lod_points</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">4</span><span class="p">,</span> <span class="n">lod_points_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize peak directions as given from ``peaks_from_model``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    peaks_dirs : ndarray</span>
<span class="sd">        Peak directions. The shape of the array can be (M, 3) or (X, M, 3) or</span>
<span class="sd">        (X, Y, M, 3) or (X, Y, Z, M, 3)</span>
<span class="sd">    peaks_values : ndarray</span>
<span class="sd">        Peak values. The shape of the array can be (M, ) or (X, M) or</span>
<span class="sd">        (X, Y, M) or (X, Y, Z, M)</span>
<span class="sd">    affine : array</span>
<span class="sd">        4x4 transformation array from native coordinates to world coordinates</span>
<span class="sd">    mask : ndarray</span>
<span class="sd">        3D mask</span>
<span class="sd">    colors : tuple or None</span>
<span class="sd">        Default red color. If None then every peak gets an orientation color</span>
<span class="sd">        in similarity to a DEC map.</span>

<span class="sd">    opacity : float, optional</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque)</span>

<span class="sd">    linewidth : float, optional</span>
<span class="sd">        Line thickness. Default is 1.</span>

<span class="sd">    lod : bool</span>
<span class="sd">        Use vtkLODActor(level of detail) rather than vtkActor.</span>
<span class="sd">        Default is False. Level of detail actors do not render the full</span>
<span class="sd">        geometry when the frame rate is low.</span>
<span class="sd">    lod_points : int</span>
<span class="sd">        Number of points to be used when LOD is in effect. Default is 10000.</span>
<span class="sd">    lod_points_size : int</span>
<span class="sd">        Size of points when lod is in effect. Default is 3.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    fury.actor.odf_slicer</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">peaks_dirs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">peaks_dirs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">peaks_dirs</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong shape&quot;</span><span class="p">)</span>

    <span class="n">peaks_dirs</span> <span class="o">=</span> <span class="n">_makeNd</span><span class="p">(</span><span class="n">peaks_dirs</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">peaks_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">peaks_values</span> <span class="o">=</span> <span class="n">_makeNd</span><span class="p">(</span><span class="n">peaks_values</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">grid_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">peaks_dirs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">PeakSlicerActor</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkLODActor</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">display_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>

            <span class="n">tmp_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
            <span class="n">tmp_mask</span><span class="p">[</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span><span class="n">y2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z1</span><span class="p">:</span><span class="n">z2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">tmp_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">tmp_mask</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="n">ijk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tmp_mask</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ijk</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">affine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ijk_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">apply_affine</span><span class="p">(</span><span class="n">affine</span><span class="p">,</span> <span class="n">ijk</span><span class="p">))</span>
            <span class="n">list_dirs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">center</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ijk</span><span class="p">):</span>
                <span class="c1"># center = tuple(center)</span>
                <span class="k">if</span> <span class="n">affine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">xyz</span> <span class="o">=</span> <span class="n">center</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xyz</span> <span class="o">=</span> <span class="n">ijk_trans</span><span class="p">[</span><span class="n">index</span><span class="p">][:,</span> <span class="kc">None</span><span class="p">]</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">T</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">peaks_dirs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]):</span>

                    <span class="k">if</span> <span class="n">peaks_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pv</span> <span class="o">=</span> <span class="n">peaks_values</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pv</span> <span class="o">=</span> <span class="mf">1.</span>
                    <span class="n">symm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="o">-</span><span class="n">peaks_dirs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">pv</span> <span class="o">+</span> <span class="n">xyz</span><span class="p">,</span>
                                      <span class="n">peaks_dirs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">center</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">pv</span> <span class="o">+</span> <span class="n">xyz</span><span class="p">))</span>
                    <span class="n">list_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symm</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">list_dirs</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                             <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                             <span class="n">lod</span><span class="o">=</span><span class="n">lod</span><span class="p">,</span> <span class="n">lod_points</span><span class="o">=</span><span class="n">lod_points</span><span class="p">,</span>
                             <span class="n">lod_points_size</span><span class="o">=</span><span class="n">lod_points_size</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">SetProperty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">())</span>

        <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                    <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

    <span class="n">peak_actor</span> <span class="o">=</span> <span class="n">PeakSlicerActor</span><span class="p">()</span>

    <span class="n">szx</span><span class="p">,</span> <span class="n">szy</span><span class="p">,</span> <span class="n">szz</span> <span class="o">=</span> <span class="n">grid_shape</span>
    <span class="n">peak_actor</span><span class="o">.</span><span class="n">display_extent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                              <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">szz</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">peak_actor</span></div>


<div class="viewcode-block" id="dots"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.dots">[docs]</a><span class="k">def</span> <span class="nf">dots</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dot_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create one or more 3d points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : ndarray, (N, 3)</span>
<span class="sd">    color : tuple (3,)</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque)</span>
<span class="sd">    dot_size : int</span>

<span class="sd">    Returns</span>
<span class="sd">    --------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    See Also</span>
<span class="sd">    ---------</span>
<span class="sd">    fury.actor.point</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">points_no</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">points_no</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">polyVertexPoints</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">polyVertexPoints</span><span class="o">.</span><span class="n">SetNumberOfPoints</span><span class="p">(</span><span class="n">points_no</span><span class="p">)</span>
    <span class="n">aPolyVertex</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyVertex</span><span class="p">()</span>
    <span class="n">aPolyVertex</span><span class="o">.</span><span class="n">GetPointIds</span><span class="p">()</span><span class="o">.</span><span class="n">SetNumberOfIds</span><span class="p">(</span><span class="n">points_no</span><span class="p">)</span>

    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
            <span class="n">polyVertexPoints</span><span class="o">.</span><span class="n">InsertPoint</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">aPolyVertex</span><span class="o">.</span><span class="n">GetPointIds</span><span class="p">()</span><span class="o">.</span><span class="n">SetId</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">cnt</span><span class="p">)</span>
            <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">polyVertexPoints</span><span class="o">.</span><span class="n">InsertPoint</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">aPolyVertex</span><span class="o">.</span><span class="n">GetPointIds</span><span class="p">()</span><span class="o">.</span><span class="n">SetId</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">cnt</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">aPolyVertexGrid</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkUnstructuredGrid</span><span class="p">()</span>
    <span class="n">aPolyVertexGrid</span><span class="o">.</span><span class="n">Allocate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">aPolyVertexGrid</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">aPolyVertex</span><span class="o">.</span><span class="n">GetCellType</span><span class="p">(),</span>
                                   <span class="n">aPolyVertex</span><span class="o">.</span><span class="n">GetPointIds</span><span class="p">())</span>

    <span class="n">aPolyVertexGrid</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">polyVertexPoints</span><span class="p">)</span>
    <span class="n">aPolyVertexMapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkDataSetMapper</span><span class="p">()</span>
    <span class="n">aPolyVertexMapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">aPolyVertexGrid</span><span class="p">)</span>
    <span class="n">aPolyVertexActor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">aPolyVertexActor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">aPolyVertexMapper</span><span class="p">)</span>

    <span class="n">aPolyVertexActor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">aPolyVertexActor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>
    <span class="n">aPolyVertexActor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetPointSize</span><span class="p">(</span><span class="n">dot_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aPolyVertexActor</span></div>


<div class="viewcode-block" id="point"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.point">[docs]</a><span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">_opacity</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">point_radius</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize points as sphere glyphs</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : ndarray, shape (N, 3)</span>
<span class="sd">    colors : ndarray (N,3) or tuple (3,)</span>
<span class="sd">    point_radius : float</span>
<span class="sd">    theta : int</span>
<span class="sd">    phi : int</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Takes values from 0 (fully transparent) to 1 (opaque)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; pts = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; point_actor = actor.point(pts, window.colors.coral)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(point_actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sphere</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">points</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">point_radius</span><span class="p">,</span>
                  <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>


<div class="viewcode-block" id="sphere"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.sphere">[docs]</a><span class="k">def</span> <span class="nf">sphere</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
           <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize one or many spheres with different colors and radii</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Spheres positions</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    radii : float or ndarray, shape (N,)</span>
<span class="sd">        Sphere radius</span>
<span class="sd">    theta : int</span>
<span class="sd">    phi : int</span>
<span class="sd">    vertices : ndarray, shape (N, 3)</span>
<span class="sd">        The point cloud defining the sphere.</span>
<span class="sd">    faces : ndarray, shape (M, 3)</span>
<span class="sd">        If faces is None then a sphere is created based on theta and phi angles</span>
<span class="sd">        If not then a sphere is created with the provided vertices and faces.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; centers = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; sphere_actor = actor.sphere(centers, window.colors.coral)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(sphere_actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkSphereSource</span><span class="p">()</span> <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">src</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetThetaResolution</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetPhiResolution</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">repeat_sources</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                           <span class="n">active_scalars</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                           <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="cylinder"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.cylinder">[docs]</a><span class="k">def</span> <span class="nf">cylinder</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">heights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">capped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize one or many cylinder with different features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Cylinder positions</span>
<span class="sd">    directions : ndarray, shape (N, 3)</span>
<span class="sd">        The orientation vector of the cylinder.</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    radius : float</span>
<span class="sd">        cylinder radius, default: 1</span>
<span class="sd">    heights : ndarray, shape (N)</span>
<span class="sd">        The height of the arrow.</span>
<span class="sd">    capped : bool</span>
<span class="sd">        Turn on/off whether to cap cylinder with polygons. Default (False)</span>
<span class="sd">    resolution: int</span>
<span class="sd">        Number of facets used to define cylinder.</span>
<span class="sd">    vertices : ndarray, shape (N, 3)</span>
<span class="sd">        The point cloud defining the sphere.</span>
<span class="sd">    faces : ndarray, shape (M, 3)</span>
<span class="sd">        If faces is None then a sphere is created based on theta and phi angles</span>
<span class="sd">        If not then a sphere is created with the provided vertices and faces.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; centers = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; dirs = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; heights = np.random.rand(5)</span>
<span class="sd">    &gt;&gt;&gt; actor = actor.cylinder(centers, dirs, (1, 1, 1), heights=heights)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCylinderSource</span><span class="p">()</span> <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">src</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetCapping</span><span class="p">(</span><span class="n">capped</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">repeat_sources</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                           <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">,</span>
                           <span class="n">active_scalars</span><span class="o">=</span><span class="n">heights</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                           <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="box"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.box">[docs]</a><span class="k">def</span> <span class="nf">box</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">heights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize one or many Box with different features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Box positions</span>
<span class="sd">    directions : ndarray, shape (N, 3)</span>
<span class="sd">        The orientation vector of the box.</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    size : tuple (3,)</span>
<span class="sd">        Box lengths on each direction (x, y, z), default(1, 2, 3)</span>
<span class="sd">    heights : ndarray, shape (N)</span>
<span class="sd">        The height of the arrow.</span>
<span class="sd">    vertices : ndarray, shape (N, 3)</span>
<span class="sd">        The point cloud defining the sphere.</span>
<span class="sd">    faces : ndarray, shape (M, 3)</span>
<span class="sd">        If faces is None then a sphere is created based on theta and phi angles</span>
<span class="sd">        If not then a sphere is created with the provided vertices and faces.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; centers = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; dirs = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; heights = np.random.rand(5)</span>
<span class="sd">    &gt;&gt;&gt; box_actor = actor.box(centers, dirs, (1, 1, 1), heights=heights)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(box_actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCubeSource</span><span class="p">()</span> <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">src</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetXLength</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetYLength</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetZLength</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">repeat_sources</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                           <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">,</span>
                           <span class="n">active_scalars</span><span class="o">=</span><span class="n">heights</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                           <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="cube"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.cube">[docs]</a><span class="k">def</span> <span class="nf">cube</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">heights</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize one or many cube with different features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Cube positions</span>
<span class="sd">    directions : ndarray, shape (N, 3)</span>
<span class="sd">        The orientation vector of the cube.</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    heights : ndarray, shape (N)</span>
<span class="sd">        The height of the arrow.</span>
<span class="sd">    vertices : ndarray, shape (N, 3)</span>
<span class="sd">        The point cloud defining the sphere.</span>
<span class="sd">    faces : ndarray, shape (M, 3)</span>
<span class="sd">        If faces is None then a sphere is created based on theta and phi angles</span>
<span class="sd">        If not then a sphere is created with the provided vertices and faces.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; centers = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; dirs = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; heights = np.random.rand(5)</span>
<span class="sd">    &gt;&gt;&gt; cube_actor = actor.cube(centers, dirs, (1, 1, 1), heights=heights)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(cube_actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">box</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
               <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">heights</span><span class="o">=</span><span class="n">heights</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">)</span></div>


<div class="viewcode-block" id="arrow"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.arrow">[docs]</a><span class="k">def</span> <span class="nf">arrow</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">heights</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
          <span class="n">tip_length</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shaft_radius</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
          <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize one or many arrow with differents features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Arrow positions</span>
<span class="sd">    directions : ndarray, shape (N, 3)</span>
<span class="sd">        The orientation vector of the arrow.</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    heights : ndarray, shape (N)</span>
<span class="sd">        The height of the arrow.</span>
<span class="sd">    resolution : int</span>
<span class="sd">        The resolution of the arrow.</span>
<span class="sd">    tip_length : float</span>
<span class="sd">        The tip size of the arrow (default: 0.35)</span>
<span class="sd">    tip_radius : float</span>
<span class="sd">        the tip radius of the arrow (default: 0.1)</span>
<span class="sd">    shaft_radius : float</span>
<span class="sd">        The shaft radius of the arrow (default: 0.03)</span>
<span class="sd">    vertices : ndarray, shape (N, 3)</span>
<span class="sd">        The point cloud defining the arrow.</span>
<span class="sd">    faces : ndarray, shape (M, 3)</span>
<span class="sd">        If faces is None then a arrow is created based on directions, heights</span>
<span class="sd">        and resolution. If not then a arrow is created with the provided</span>
<span class="sd">        vertices and faces.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; centers = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; directions = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; heights = np.random.rand(5)</span>
<span class="sd">    &gt;&gt;&gt; arrow_actor = actor.arrow(centers, directions, (1, 1, 1), heights)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(arrow_actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkArrowSource</span><span class="p">()</span> <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">src</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetTipResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetShaftResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetTipLength</span><span class="p">(</span><span class="n">tip_length</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetTipRadius</span><span class="p">(</span><span class="n">tip_radius</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetShaftRadius</span><span class="p">(</span><span class="n">shaft_radius</span><span class="p">)</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">repeat_sources</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">,</span>
                           <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">active_scalars</span><span class="o">=</span><span class="n">heights</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                           <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="cone"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.cone">[docs]</a><span class="k">def</span> <span class="nf">cone</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">heights</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
         <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize one or many cones with different features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Cone positions</span>
<span class="sd">    directions : ndarray, shape (N, 3)</span>
<span class="sd">        The orientation vector of the cone.</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    heights : ndarray, shape (N)</span>
<span class="sd">        The height of the cone.</span>
<span class="sd">    resolution : int</span>
<span class="sd">        The resolution of the cone.</span>
<span class="sd">    vertices : ndarray, shape (N, 3)</span>
<span class="sd">        The point cloud defining the cone.</span>
<span class="sd">    faces : ndarray, shape (M, 3)</span>
<span class="sd">        If faces is None then a cone is created based on directions, heights</span>
<span class="sd">        and resolution. If not then a cone is created with the provided</span>
<span class="sd">        vertices and faces.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; centers = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; directions = np.random.rand(5, 3)</span>
<span class="sd">    &gt;&gt;&gt; heights = np.random.rand(5)</span>
<span class="sd">    &gt;&gt;&gt; cone_actor = actor.cone(centers, directions, (1, 1, 1), heights)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(cone_actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkConeSource</span><span class="p">()</span> <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">src</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">SetResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">repeat_sources</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">,</span>
                           <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">active_scalars</span><span class="o">=</span><span class="n">heights</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                           <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="superquadric"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.superquadric">[docs]</a><span class="k">def</span> <span class="nf">superquadric</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">roundness</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">directions</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                 <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Visualize one or many superquadrics with different features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Superquadrics positions</span>
<span class="sd">    roundness : ndarray, shape (N, 2) or tuple/list (2,), optional</span>
<span class="sd">        parameters (Phi and Theta) that control the shape of the superquadric</span>
<span class="sd">    directions : ndarray, shape (N, 3) or tuple (3,), optional</span>
<span class="sd">        The orientation vector of the cone.</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    scale : ndarray, shape (N) or (N,3) or float or int, optional</span>
<span class="sd">        The height of the cone.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; centers = np.random.rand(3, 3) * 10</span>
<span class="sd">    &gt;&gt;&gt; directions = np.random.rand(3, 3)</span>
<span class="sd">    &gt;&gt;&gt; scale = np.random.rand(5)</span>
<span class="sd">    &gt;&gt;&gt; roundness = np.array([[1, 1], [1, 2], [2, 1]])</span>
<span class="sd">    &gt;&gt;&gt; sq_actor = actor.superquadric(centers, roundness=roundness,</span>
<span class="sd">    ...                               directions=directions,</span>
<span class="sd">    ...                               colors=colors, scale=scale)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(sq_actor)</span>
<span class="sd">    &gt;&gt;&gt; # window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">have_2_dimensions</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">)</span>

    <span class="c1"># reshape roundness to a valid numpy array</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">roundness</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span>
       <span class="nb">len</span><span class="p">(</span><span class="n">roundness</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">have_2_dimensions</span><span class="p">(</span><span class="n">roundness</span><span class="p">)):</span>
        <span class="n">roundness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">roundness</span><span class="p">]</span> <span class="o">*</span> <span class="n">centers</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roundness</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">roundness</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">roundness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">roundness</span><span class="p">,</span> <span class="n">centers</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">roundness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">roundness</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">repeat_primitive_function</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">fp</span><span class="o">.</span><span class="n">prim_superquadric</span><span class="p">,</span>
                                       <span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span>
                                       <span class="n">func_args</span><span class="o">=</span><span class="n">roundness</span><span class="p">,</span>
                                       <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">,</span>
                                       <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

    <span class="n">big_verts</span><span class="p">,</span> <span class="n">big_faces</span><span class="p">,</span> <span class="n">big_colors</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">res</span>
    <span class="n">actor</span> <span class="o">=</span> <span class="n">get_actor_from_primitive</span><span class="p">(</span><span class="n">big_verts</span><span class="p">,</span> <span class="n">big_faces</span><span class="p">,</span> <span class="n">big_colors</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="billboard"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.billboard">[docs]</a><span class="k">def</span> <span class="nf">billboard</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vs_dec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vs_impl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">fs_dec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fs_impl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gs_dec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gs_impl</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a billboard actor.</span>

<span class="sd">    Billboards are 2D elements incrusted in a 3D world. It offers you the</span>
<span class="sd">    possibility to draw differents shapes/elements at the shader level.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    centers : ndarray, shape (N, 3)</span>
<span class="sd">        Superquadrics positions</span>
<span class="sd">    colors : ndarray (N,3) or (N, 4) or tuple (3,) or tuple (4,)</span>
<span class="sd">        RGB or RGBA (for opacity) R, G, B and A should be at the range [0, 1]</span>
<span class="sd">    scale : ndarray, shape (N) or (N,3) or float or int, optional</span>
<span class="sd">        The height of the cone.</span>
<span class="sd">    vs_dec : str or list of str, optional</span>
<span class="sd">        vertex shaders code that contains all variable/function delarations</span>
<span class="sd">    vs_impl : str or list of str, optional</span>
<span class="sd">        vertex shaders code that contains all variable/function implementation</span>
<span class="sd">    fs_dec : str or list of str, optional</span>
<span class="sd">        Fragment shaders code that contains all variable/function delarations</span>
<span class="sd">    fs_impl : str or list of str, optional</span>
<span class="sd">        Fragment shaders code that contains all variable/function</span>
<span class="sd">        implementation</span>
<span class="sd">    gs_dec : str or list of str, optional</span>
<span class="sd">        Geometry shaders code that contains all variable/function delarations</span>
<span class="sd">    gs_impl : str or list of str, optional</span>
<span class="sd">        Geometry shaders code that contains all variable/function</span>
<span class="sd">        mplementation</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">verts</span><span class="p">,</span> <span class="n">faces</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">prim_square</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">repeat_primitive</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                              <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

    <span class="n">big_verts</span><span class="p">,</span> <span class="n">big_faces</span><span class="p">,</span> <span class="n">big_colors</span><span class="p">,</span> <span class="n">big_centers</span> <span class="o">=</span> <span class="n">res</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">get_actor_from_primitive</span><span class="p">(</span><span class="n">big_verts</span><span class="p">,</span> <span class="n">big_faces</span><span class="p">,</span> <span class="n">big_colors</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">BackfaceCullingOff</span><span class="p">()</span>
    <span class="n">vtk_centers</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">big_centers</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vtk_centers</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">vtk_centers</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">vtk_centers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_code</span><span class="p">(</span><span class="n">glsl_code</span><span class="p">):</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">glsl_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">code</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">glsl_code</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;The only supported format are string or filename,&quot;</span>
                          <span class="s2">&quot;list of string or filename&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">glsl_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="n">fs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">glsl_code</span><span class="p">)</span> <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">glsl_code</span><span class="p">)</span> <span class="k">else</span> <span class="n">glsl_code</span>
            <span class="k">return</span> <span class="n">code</span>

        <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">glsl_code</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="n">fs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="k">else</span> <span class="n">content</span>
        <span class="k">return</span> <span class="n">code</span>

    <span class="n">vs_dec_code</span> <span class="o">=</span> <span class="n">get_code</span><span class="p">(</span><span class="n">vs_dec</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">fs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;billboard_dec.vert&quot;</span><span class="p">)</span>
    <span class="n">vs_impl_code</span> <span class="o">=</span> <span class="n">get_code</span><span class="p">(</span><span class="n">vs_impl</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">fs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;billboard_impl.vert&quot;</span><span class="p">)</span>
    <span class="n">fs_dec_code</span> <span class="o">=</span> <span class="n">get_code</span><span class="p">(</span><span class="n">fs_dec</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">fs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;billboard_dec.frag&quot;</span><span class="p">)</span>
    <span class="n">fs_impl_code</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;billboard_impl.frag&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">get_code</span><span class="p">(</span><span class="n">fs_impl</span><span class="p">)</span>
    <span class="n">gs_dec_code</span> <span class="o">=</span> <span class="n">get_code</span><span class="p">(</span><span class="n">gs_dec</span><span class="p">)</span>
    <span class="n">gs_impl_code</span> <span class="o">=</span> <span class="n">get_code</span><span class="p">(</span><span class="n">gs_impl</span><span class="p">)</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">MapDataArrayToVertexAttribute</span><span class="p">(</span>
        <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkDataObject</span><span class="o">.</span><span class="n">FIELD_ASSOCIATION_POINTS</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">mapper</span><span class="o">.</span><span class="n">AddShaderReplacement</span><span class="p">(</span>
        <span class="n">vtk</span><span class="o">.</span><span class="n">vtkShader</span><span class="o">.</span><span class="n">Vertex</span><span class="p">,</span> <span class="s2">&quot;//VTK::ValuePass::Dec&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">vs_dec_code</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">mapper</span><span class="o">.</span><span class="n">AddShaderReplacement</span><span class="p">(</span>
        <span class="n">vtk</span><span class="o">.</span><span class="n">vtkShader</span><span class="o">.</span><span class="n">Vertex</span><span class="p">,</span> <span class="s2">&quot;//VTK::ValuePass::Impl&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">vs_impl_code</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">mapper</span><span class="o">.</span><span class="n">AddShaderReplacement</span><span class="p">(</span>
        <span class="n">vtk</span><span class="o">.</span><span class="n">vtkShader</span><span class="o">.</span><span class="n">Fragment</span><span class="p">,</span> <span class="s2">&quot;//VTK::ValuePass::Dec&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">fs_dec_code</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">mapper</span><span class="o">.</span><span class="n">AddShaderReplacement</span><span class="p">(</span>
        <span class="n">vtk</span><span class="o">.</span><span class="n">vtkShader</span><span class="o">.</span><span class="n">Fragment</span><span class="p">,</span> <span class="s2">&quot;//VTK::Light::Impl&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">fs_impl_code</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">mapper</span><span class="o">.</span><span class="n">AddShaderReplacement</span><span class="p">(</span>
        <span class="n">vtk</span><span class="o">.</span><span class="n">vtkShader</span><span class="o">.</span><span class="n">Geometry</span><span class="p">,</span> <span class="s2">&quot;//VTK::Output::Dec&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">gs_dec_code</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">mapper</span><span class="o">.</span><span class="n">AddShaderReplacement</span><span class="p">(</span>
        <span class="n">vtk</span><span class="o">.</span><span class="n">vtkShader</span><span class="o">.</span><span class="n">Geometry</span><span class="p">,</span> <span class="s2">&quot;//VTK::Output::Impl&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">gs_impl_code</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">actor</span></div>


<div class="viewcode-block" id="label"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.label">[docs]</a><span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;Origin&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
          <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Create a label actor.</span>

<span class="sd">    This actor will always face the camera</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    text : str</span>
<span class="sd">        Text for the label.</span>
<span class="sd">    pos : (3,) array_like, optional</span>
<span class="sd">        Left down position of the label.</span>
<span class="sd">    scale : (3,) array_like</span>
<span class="sd">        Changes the size of the label.</span>
<span class="sd">    color : (3,) array_like</span>
<span class="sd">        Label color as ``(r,g,b)`` tuple.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    l : vtkActor object</span>
<span class="sd">        Label.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from fury import window, actor</span>
<span class="sd">    &gt;&gt;&gt; scene = window.Scene()</span>
<span class="sd">    &gt;&gt;&gt; l = actor.label(text=&#39;Hello&#39;)</span>
<span class="sd">    &gt;&gt;&gt; scene.add(l)</span>
<span class="sd">    &gt;&gt;&gt; #window.show(scene)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atext</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkVectorText</span><span class="p">()</span>
    <span class="n">atext</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="n">textm</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">textm</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">atext</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

    <span class="n">texta</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFollower</span><span class="p">()</span>
    <span class="n">texta</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">textm</span><span class="p">)</span>
    <span class="n">texta</span><span class="o">.</span><span class="n">SetScale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>

    <span class="n">texta</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">texta</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">texta</span></div>


<div class="viewcode-block" id="text_3d"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.text_3d">[docs]</a><span class="k">def</span> <span class="nf">text_3d</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">font_family</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">justification</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">vertical_justification</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
            <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Generate 2D text that lives in the 3D world</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    text : str</span>
<span class="sd">    position : tuple</span>
<span class="sd">    color : tuple</span>
<span class="sd">    font_size : int</span>
<span class="sd">    font_family : str</span>
<span class="sd">    justification : str</span>
<span class="sd">        Left, center or right (default left)</span>
<span class="sd">    vertical_justification : str</span>
<span class="sd">        Bottom, middle or top (default bottom)</span>
<span class="sd">    bold : bool</span>
<span class="sd">    italic : bool</span>
<span class="sd">    shadow : bool</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    textActor3D</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">TextActor3D</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkTextActor3D</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_message</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">set_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_user_matrix</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">get_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">font_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetFontSize</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
            <span class="n">text_actor</span><span class="o">.</span><span class="n">SetScale</span><span class="p">((</span><span class="mf">1.</span><span class="o">/</span><span class="mf">24.</span><span class="o">*</span><span class="n">size</span><span class="p">,)</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_user_matrix</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">font_family</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_family</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetFontFamilyToArial</span><span class="p">()</span>
            <span class="c1"># self._update_user_matrix()</span>

        <span class="k">def</span> <span class="nf">justification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">justification</span><span class="p">):</span>
            <span class="n">tprop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">justification</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">SetJustificationToLeft</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">justification</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">SetJustificationToCentered</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">justification</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">SetJustificationToRight</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown justification: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">justification</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_update_user_matrix</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">vertical_justification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">justification</span><span class="p">):</span>
            <span class="n">tprop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">justification</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">SetVerticalJustificationToTop</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">justification</span> <span class="o">==</span> <span class="s1">&#39;middle&#39;</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">SetVerticalJustificationToCentered</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">justification</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">SetVerticalJustificationToBottom</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown vertical justification: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">justification</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_update_user_matrix</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">font_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">tprop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">bold</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">BoldOn</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">BoldOff</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">italic</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">ItalicOn</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">ItalicOff</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">shadow</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">ShadowOn</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tprop</span><span class="o">.</span><span class="n">ShadowOff</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_update_user_matrix</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="o">*</span><span class="n">color</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_update_user_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Text justification of vtkTextActor3D doesn&#39;t seem to be</span>
<span class="sd">            working, so we do it manually. Yeah!</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">user_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

            <span class="n">text_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetBoundingBox</span><span class="p">(</span><span class="n">text_bounds</span><span class="p">)</span>

            <span class="n">tprop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">tprop</span><span class="o">.</span><span class="n">GetJustification</span><span class="p">()</span> <span class="o">==</span> <span class="n">vtk</span><span class="o">.</span><span class="n">VTK_TEXT_LEFT</span><span class="p">:</span>
                <span class="n">user_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tprop</span><span class="o">.</span><span class="n">GetJustification</span><span class="p">()</span> <span class="o">==</span> <span class="n">vtk</span><span class="o">.</span><span class="n">VTK_TEXT_CENTERED</span><span class="p">:</span>
                <span class="n">tm</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">text_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
                <span class="n">user_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">tm</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tprop</span><span class="o">.</span><span class="n">GetJustification</span><span class="p">()</span> <span class="o">==</span> <span class="n">vtk</span><span class="o">.</span><span class="n">VTK_TEXT_RIGHT</span><span class="p">:</span>
                <span class="n">user_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tprop</span><span class="o">.</span><span class="n">GetVerticalJustification</span><span class="p">()</span> <span class="o">==</span> <span class="n">vtk</span><span class="o">.</span><span class="n">VTK_TEXT_BOTTOM</span><span class="p">:</span>
                <span class="n">user_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tprop</span><span class="o">.</span><span class="n">GetVerticalJustification</span><span class="p">()</span> <span class="o">==</span> <span class="n">vtk</span><span class="o">.</span><span class="n">VTK_TEXT_CENTERED</span><span class="p">:</span>
                <span class="n">tm</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">text_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
                <span class="n">user_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tm</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tprop</span><span class="o">.</span><span class="n">GetVerticalJustification</span><span class="p">()</span> <span class="o">==</span> <span class="n">vtk</span><span class="o">.</span><span class="n">VTK_TEXT_TOP</span><span class="p">:</span>
                <span class="n">user_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">text_bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">user_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetScale</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetUserMatrix</span><span class="p">(</span><span class="n">numpy_to_vtk_matrix</span><span class="p">(</span><span class="n">user_matrix</span><span class="p">))</span>

    <span class="n">text_actor</span> <span class="o">=</span> <span class="n">TextActor3D</span><span class="p">()</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">font_size</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">font_family</span><span class="p">(</span><span class="n">font_family</span><span class="p">)</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">font_style</span><span class="p">(</span><span class="n">bold</span><span class="p">,</span> <span class="n">italic</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">justification</span><span class="p">(</span><span class="n">justification</span><span class="p">)</span>
    <span class="n">text_actor</span><span class="o">.</span><span class="n">vertical_justification</span><span class="p">(</span><span class="n">vertical_justification</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">text_actor</span></div>


<div class="viewcode-block" id="Container"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container">[docs]</a><span class="k">class</span> <span class="nc">Container</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Provides functionalities for grouping multiple actors using a given</span>
<span class="sd">    layout.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    anchor : 3-tuple of float</span>
<span class="sd">        Anchor of this container used when laying out items in a container.</span>
<span class="sd">        The anchor point is relative to the center of the container.</span>
<span class="sd">        Default: (0, 0, 0).</span>

<span class="sd">    padding : 6-tuple of float</span>
<span class="sd">        Padding around this container bounding box. The 6-tuple represents</span>
<span class="sd">        (pad_x_neg, pad_x_pos, pad_y_neg, pad_y_pos, pad_z_neg, pad_z_pos).</span>
<span class="sd">        Default: (0, 0, 0, 0, 0, 0)</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Container.__init__"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="o">.</span><span class="n">Layout</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        layout : ``fury.layout.Layout`` object</span>
<span class="sd">            Items of this container will be arranged according to `layout`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_need_update</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visibility</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_need_update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span>

<div class="viewcode-block" id="Container.add"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">items</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds some items to this container.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        items : `vtkProp3D` objects</span>
<span class="sd">            Items to add to this container.</span>
<span class="sd">        borrow : bool</span>
<span class="sd">            If True the items are added as-is, otherwise a shallow copy is</span>
<span class="sd">            made first. If you intend to reuse the items elsewhere you</span>
<span class="sd">            should set `borrow=False`. Default: True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_need_update</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;borrow&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">shallow_copy</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.clear"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clears all items of this container. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_need_update</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="p">[:]</span></div>

<div class="viewcode-block" id="Container.update"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates the position of the items of this container. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_need_update</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Container.add_to_scene"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.add_to_scene">[docs]</a>    <span class="k">def</span> <span class="nf">add_to_scene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ren</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds the items of this container to a given renderer. &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">item</span><span class="o">.</span><span class="n">add_to_scene</span><span class="p">(</span><span class="n">ren</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ren</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.GetBounds"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.GetBounds">[docs]</a>    <span class="k">def</span> <span class="nf">GetBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the bounds of the container. &quot;&quot;&quot;</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>    <span class="c1"># x1, x2, y1, y2, z1, z2</span>
        <span class="n">bounds</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>    <span class="c1"># x1, y1, z1</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>  <span class="c1"># x2, y2, z2</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">item_bounds</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">GetBounds</span><span class="p">()</span>
            <span class="n">bounds</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bounds</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">item_bounds</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">item_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># Add padding, if any.</span>
        <span class="n">bounds</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.GetVisibility"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.GetVisibility">[docs]</a>    <span class="k">def</span> <span class="nf">GetVisibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visibility</span></div>

<div class="viewcode-block" id="Container.SetVisibility"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.SetVisibility">[docs]</a>    <span class="k">def</span> <span class="nf">SetVisibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visibility</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visibility</span> <span class="o">=</span> <span class="n">visibility</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="n">visibility</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.GetPosition"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.GetPosition">[docs]</a>    <span class="k">def</span> <span class="nf">GetPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span></div>

<div class="viewcode-block" id="Container.AddPosition"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.AddPosition">[docs]</a>    <span class="k">def</span> <span class="nf">AddPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">+=</span> <span class="n">position</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">AddPosition</span><span class="p">(</span><span class="n">position</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.SetPosition"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.SetPosition">[docs]</a>    <span class="k">def</span> <span class="nf">SetPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddPosition</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.GetCenter"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.GetCenter">[docs]</a>    <span class="k">def</span> <span class="nf">GetCenter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the center of the bounding box. &quot;&quot;&quot;</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetBounds</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span><span class="o">+</span><span class="n">y2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="p">(</span><span class="n">z1</span><span class="o">+</span><span class="n">z2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.GetLength"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.GetLength">[docs]</a>    <span class="k">def</span> <span class="nf">GetLength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the length of bounding box diagonal. &quot;&quot;&quot;</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetBounds</span><span class="p">()</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span> <span class="n">z2</span><span class="o">-</span><span class="n">z1</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">width</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">depth</span><span class="o">**</span><span class="mi">2</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Container.NewInstance"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.NewInstance">[docs]</a>    <span class="k">def</span> <span class="nf">NewInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.ShallowCopy"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.Container.ShallowCopy">[docs]</a>    <span class="k">def</span> <span class="nf">ShallowCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_position</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">anchor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">_items</span><span class="p">,</span> <span class="n">borrow</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="p">)</span></div>


<div class="viewcode-block" id="grid"><a class="viewcode-back" href="../../reference/fury.ui.html#fury.actor.grid">[docs]</a><span class="k">def</span> <span class="nf">grid</span><span class="p">(</span><span class="n">actors</span><span class="p">,</span> <span class="n">captions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">caption_offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">cell_padding</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
         <span class="n">cell_shape</span><span class="o">=</span><span class="s2">&quot;rect&quot;</span><span class="p">,</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">16</span><span class="o">/</span><span class="mf">9.</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Creates a grid of actors that lies in the xy-plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    actors : list of `vtkProp3D` objects</span>
<span class="sd">        Actors to be layout in a grid manner.</span>
<span class="sd">    captions : list of `vtkProp3D` objects or list of str</span>
<span class="sd">        Objects serving as captions (can be any `vtkProp3D` object, not</span>
<span class="sd">        necessarily text). There should be one caption per actor. By</span>
<span class="sd">        default, there are no captions.</span>
<span class="sd">    caption_offset : tuple of float (optional)</span>
<span class="sd">        Tells where to position the caption w.r.t. the center of its</span>
<span class="sd">        associated actor. Default: (0, -100, 0).</span>
<span class="sd">    cell_padding : tuple of 2 floats or float</span>
<span class="sd">        Each grid cell will be padded according to (pad_x, pad_y) i.e.</span>
<span class="sd">        horizontally and vertically. Padding is evenly distributed on each</span>
<span class="sd">        side of the cell. If a single float is provided then both pad_x and</span>
<span class="sd">        pad_y will have the same value.</span>
<span class="sd">    cell_shape : str</span>
<span class="sd">        Specifies the desired shape of every grid cell.</span>
<span class="sd">        &#39;rect&#39; ensures the cells are the tightest.</span>
<span class="sd">        &#39;square&#39; ensures the cells are as wide as high.</span>
<span class="sd">        &#39;diagonal&#39; ensures the content of the cells can be rotated without</span>
<span class="sd">        colliding with content of the neighboring cells.</span>
<span class="sd">    aspect_ratio : float</span>
<span class="sd">        Aspect ratio of the grid (width/height). Default: 16:9.</span>
<span class="sd">    dim : tuple of int</span>
<span class="sd">        Dimension (nb_rows, nb_cols) of the grid. If provided,</span>
<span class="sd">        `aspect_ratio` will be ignored.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ``fury.actor.Container`` object</span>
<span class="sd">        Object that represents the grid containing all the actors and</span>
<span class="sd">        captions, if any.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">grid_layout</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="n">cell_padding</span><span class="o">=</span><span class="n">cell_padding</span><span class="p">,</span>
                                    <span class="n">cell_shape</span><span class="o">=</span><span class="n">cell_shape</span><span class="p">,</span>
                                    <span class="n">aspect_ratio</span><span class="o">=</span><span class="n">aspect_ratio</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">grid_layout</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">captions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">actors_with_caption</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">actor</span><span class="p">,</span> <span class="n">caption</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">actors</span><span class="p">,</span> <span class="n">captions</span><span class="p">):</span>

            <span class="n">actor_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">actor</span><span class="o">.</span><span class="n">GetCenter</span><span class="p">())</span>

            <span class="c1"># Offset accordingly the caption w.r.t.</span>
            <span class="c1"># the center of the associated actor.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">caption</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">caption</span> <span class="o">=</span> <span class="n">text_3d</span><span class="p">(</span><span class="n">caption</span><span class="p">,</span> <span class="n">justification</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">caption</span> <span class="o">=</span> <span class="n">shallow_copy</span><span class="p">(</span><span class="n">caption</span><span class="p">)</span>
            <span class="n">caption</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actor_center</span> <span class="o">+</span> <span class="n">caption_offset</span><span class="p">)</span>

            <span class="n">actor_with_caption</span> <span class="o">=</span> <span class="n">Container</span><span class="p">()</span>
            <span class="n">actor_with_caption</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

            <span class="c1"># We change the anchor of the container so</span>
            <span class="c1"># the actor will be centered in the</span>
            <span class="c1"># grid cell.</span>
            <span class="n">actor_with_caption</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="n">actor_center</span> <span class="o">-</span> \
                <span class="n">actor_with_caption</span><span class="o">.</span><span class="n">GetCenter</span><span class="p">()</span>
            <span class="n">actors_with_caption</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actor_with_caption</span><span class="p">)</span>

        <span class="n">actors</span> <span class="o">=</span> <span class="n">actors_with_caption</span>

    <span class="n">grid</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">actors</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grid</span></div>


<div class="viewcode-block" id="figure"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.figure">[docs]</a><span class="k">def</span> <span class="nf">figure</span><span class="p">(</span><span class="n">pic</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Return a figure as an image actor</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pic : filename or numpy RGBA array</span>
<span class="sd">    interpolation : str</span>
<span class="sd">        Options are nearest, linear or cubic. Default is nearest.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    image_actor : vtkImageActor</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pic</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">vtk_image_data</span> <span class="o">=</span> <span class="n">load_image</span><span class="p">(</span><span class="n">pic</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">pic</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">pic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>

            <span class="n">vtk_image_data</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageData</span><span class="p">()</span>
            <span class="n">vtk_image_data</span><span class="o">.</span><span class="n">AllocateScalars</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_UNSIGNED_CHAR</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

            <span class="c1"># width, height</span>
            <span class="n">vtk_image_data</span><span class="o">.</span><span class="n">SetDimensions</span><span class="p">(</span><span class="n">pic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">vtk_image_data</span><span class="o">.</span><span class="n">SetExtent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                     <span class="mi">0</span><span class="p">,</span> <span class="n">pic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                     <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">pic_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">pic</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">pic_tmp</span> <span class="o">=</span> <span class="n">pic</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">pic_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">pic_tmp</span><span class="p">)</span>
            <span class="n">uchar_array</span> <span class="o">=</span> <span class="n">numpy_support</span><span class="o">.</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">pic_tmp</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">vtk_image_data</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">uchar_array</span><span class="p">)</span>

    <span class="n">image_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageActor</span><span class="p">()</span>
    <span class="n">image_actor</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">vtk_image_data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;nearest&#39;</span><span class="p">:</span>
        <span class="n">image_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetInterpolationTypeToNearest</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
        <span class="n">image_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetInterpolationTypeToLinear</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">interpolation</span> <span class="o">==</span> <span class="s1">&#39;cubic&#39;</span><span class="p">:</span>
        <span class="n">image_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetInterpolationTypeToCubic</span><span class="p">()</span>

    <span class="n">image_actor</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">image_actor</span></div>


<div class="viewcode-block" id="texture"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.texture">[docs]</a><span class="k">def</span> <span class="nf">texture</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Map an RGB or RGBA texture on a plane</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rgb : ndarray</span>
<span class="sd">        Input 2D RGB or RGBA array. Dtype should be uint8.</span>
<span class="sd">    interp : bool</span>
<span class="sd">        Interpolate between grid centers. Default True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">rgb</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">rgb_to_vtk</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>

    <span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Get vertices and triangles, then scale it</span>
    <span class="n">vertices</span><span class="p">,</span> <span class="n">triangles</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">prim_square</span><span class="p">()</span>
    <span class="n">vertices</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

    <span class="c1"># Create a polydata</span>
    <span class="n">my_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">set_polydata_vertices</span><span class="p">(</span><span class="n">my_polydata</span><span class="p">,</span> <span class="n">vertices</span><span class="p">)</span>
    <span class="n">set_polydata_triangles</span><span class="p">(</span><span class="n">my_polydata</span><span class="p">,</span> <span class="n">triangles</span><span class="p">)</span>

    <span class="c1"># Create texture object</span>
    <span class="n">texture</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTexture</span><span class="p">()</span>
    <span class="n">texture</span><span class="o">.</span><span class="n">SetInputDataObject</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="c1"># texture.UseSRGBColorSpaceOn()</span>
    <span class="c1"># texture.SetPremultipliedAlpha(True)</span>
    <span class="k">if</span> <span class="n">interp</span><span class="p">:</span>
        <span class="n">texture</span><span class="o">.</span><span class="n">InterpolateOn</span><span class="p">()</span>

    <span class="c1"># Map texture coordinates</span>
    <span class="n">map_to_sphere</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTextureMapToPlane</span><span class="p">()</span>
    <span class="n">map_to_sphere</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">my_polydata</span><span class="p">)</span>

    <span class="c1"># Create mapper and set the mapped texture as input</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">map_to_sphere</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="c1"># Create actor and set the mapper and the texture</span>
    <span class="n">act</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">act</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
    <span class="n">act</span><span class="o">.</span><span class="n">SetTexture</span><span class="p">(</span><span class="n">texture</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">act</span></div>


<span class="k">def</span> <span class="nf">_textured_sphere_source</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">tss</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTexturedSphereSource</span><span class="p">()</span>
    <span class="n">tss</span><span class="o">.</span><span class="n">SetThetaResolution</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">tss</span><span class="o">.</span><span class="n">SetPhiResolution</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tss</span>


<div class="viewcode-block" id="texture_on_sphere"><a class="viewcode-back" href="../../reference/fury.actor.html#fury.actor.texture_on_sphere">[docs]</a><span class="k">def</span> <span class="nf">texture_on_sphere</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="n">tss</span> <span class="o">=</span> <span class="n">_textured_sphere_source</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">earthMapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">earthMapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">tss</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

    <span class="n">earthActor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">earthActor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">earthMapper</span><span class="p">)</span>

    <span class="n">atext</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTexture</span><span class="p">()</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">rgb_to_vtk</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span>
    <span class="n">atext</span><span class="o">.</span><span class="n">SetInputDataObject</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">interpolate</span><span class="p">:</span>
        <span class="n">atext</span><span class="o">.</span><span class="n">InterpolateOn</span><span class="p">()</span>
    <span class="n">earthActor</span><span class="o">.</span><span class="n">SetTexture</span><span class="p">(</span><span class="n">atext</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">earthActor</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2020, FURY

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Documentation Versions</span>
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        
            
            <li><dt>fury dev</dt></li>
            
        
            
            <li><dd><a href="/latest/_modules/fury/actor">fury latest</a></dd></li>
            
        
            
            <li><dd><a href="/v0.4.x/_modules/fury/actor">fury v0.4.x</a></dd></li>
            
        
            
            <li><dd><a href="/v0.1.x/_modules/fury/actor">fury v0.1.x</a></dd></li>
            
        
            
            <li><dd><a href="/v0.2.x/_modules/fury/actor">fury v0.2.x</a></dd></li>
            
        
            
            <li><dd><a href="/v0.3.x/_modules/fury/actor">fury v0.3.x</a></dd></li>
            
        
      </dl>
    </div>
  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    
    <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
        background: #990000;
    }
    /* Sidebar */
    .wy-nav-side {
        background: #4A3C31;
    }
    </style>
  

</body>
</html>